---
title: 傅里叶变换的幅度谱和相位谱（任务二）
date: 2024-04-24 23:00:00 +0800
categories: [Notes]
tags: []
pin: false
author: jo
toc: true
commments: true
typora-root-url: ../../Jo-CRuiSe.github.io/
math: true
mermaid: false
---

## 问题描述

1) 如果已知某一信号的幅度谱或相位谱(二者只知其一)，能否恢复出原始信号?如果可以，则需要满足什么条件?

2) 请结合具体的实例(例如声音或图像信号)进行仿真验证。

## 解决思路

### 对图像进行傅里叶与反傅里叶变换

对一个图像矩阵做傅立叶变换

```matlab
f = rgb2gray(img);
F = fft2(f);
```

取变换后的矩阵的幅值

```matlab
Fabs = abs(F);
```

取变换后的矩阵的相位

```matlab
phase_spectrum = F ./ Fabs;
```

还原频谱

```matlab
spectrum = Fabs .* phase_spectrum;
```

反傅里叶变换

```matlab
fr2 = ifft2(spectrum);
```

将矩阵改为图像类型

```matlab
ret2 = im2uint8(mat2gray(fr2));
```

### 在只有相位谱或幅度谱的情况下对信号还原

当只有相位谱时，由于相位谱保留了所有的边缘信息，所以在只有相位谱的条件下还原能大致看出图像的轮廓

<img src="/../shelter/assets/blog_res/2024-04-25傅立叶变换上机作业2.assets/phase_only.png" alt="image-20240424212836795" style="zoom:50%;" />

当只有幅度谱时，由于幅度谱包含图片的平均灰度值，缺少边缘信息，所以无法还原图片

<img src="/../shelter/assets/blog_res/2024-04-25傅立叶变换上机作业2.assets/amplitude_only.png" alt="image-20240424213141949" style="zoom:50%;" />

### 只有相位谱或幅度谱时加上特定条件对信号进行还原

如果已知相位谱的所有信息，还知道幅度谱的大致信息，我们就可以尝试进行还原

接下来用随机数作为扰动来模拟已知幅度谱的大致信息，通过`rand`函数生成与图像像素大小一致的幅度/相位矩阵

```matlab
random_amplitude = Fabs / 100 + 10 * rand(size(Fabs))
```

再结合已知相位谱，可以通过傅里叶反变换得到大致图像

```matlab
spectrum_with_random_amplitude = (Fabs / 100 + 10 * rand(size(Fabs))) .* phase_spectrum;
fr6 = ifft2(spectrum_with_random_amplitude);
ret6 = im2uint8(mat2gray(real(fr6)));
```

<img src="/../shelter/assets/blog_res/2024-04-25傅立叶变换上机作业2.assets/random_amplitude.png" alt="image-20240424213851265" style="zoom:50%;" />

已知幅度谱同理，此处省略

### 最终算法源码

```matlab
clear
clc
img = imread('Oppenheimer.jpg');
subplot(3,2,1);imshow(img);title('原图');

f = rgb2gray(img);   
F = fft2(f);          

Fabs = abs(F);      %幅度谱
phase_spectrum = F ./ abs(F);		%相位谱
spectrum_without_amplitude = phase_spectrum;
spectrum_without_phase = Fabs;

fr2 = ifft2(spectrum_without_amplitude);
fr3 = ifft2(spectrum_without_phase);
ret2 = im2uint8(mat2gray(fr2));
ret3 = im2uint8(mat2gray(fr3));
subplot(3,2,2);imshow(ret2);title('只有相位谱');
subplot(3,2,3);imshow(ret3);title('只有幅度谱');

spectrum = Fabs .* phase_spectrum;
fr4 = ifft2(spectrum);
ret4 = im2uint8(mat2gray(fr4));
subplot(3,2,4);imshow(ret4);title('完全条件');

% 结合一个相位谱分布
spectrum_with_random_phase = Fabs .* (phase_spectrum + 0.1 * rand(size(phase_spectrum)));
fr5 = real(ifft2(spectrum_with_random_phase));
ret5 = im2uint8(mat2gray(fr5));
subplot(3,2,5);imshow(ret5);title('只有相位谱');

% 结合一个幅度谱分布
spectrum_with_random_amplitude = (Fabs / 100 + 10 * rand(size(Fabs))) .* phase_spectrum;
fr6 = ifft2(spectrum_with_random_amplitude);
ret6 = im2uint8(mat2gray(real(fr6)));
subplot(3,2,6);imshow(ret6);title('只有相位谱');
```

效果如下：

<img src="/../shelter/assets/blog_res/2024-04-25傅立叶变换上机作业2.assets/finalView.png" alt="image-20240424214711199" style="zoom:30%;" />
